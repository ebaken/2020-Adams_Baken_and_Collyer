---
title:

output: 
  pdf_document:
    fig_caption: yes
    number_sections: no  #note: change to 'no' for most journals
    keep_tex: true
    pandoc_args:


csl: evolution.csl
bibliography: Lambda-Refs.bib

header-includes:
  - \usepackage{setspace}\doublespacing
  - \usepackage{lineno}\linenumbers

---
# Estimates of Phylogenetic Signal Based on Lambda are Often Inaccurate

\hfill\break

**Keywords**: Pagel's lambda, phylogenetic signal \hfill\break

**Short Title**: Inaccuracies in Pagel's Lambda \hfill\break

```{r setup, include=FALSE}
  library(knitr)
  knitr::opts_chunk$set(echo = TRUE)
```

# Abstract

{conclusion holds: interpreting the regression is not appreciably different (in terms of slopes and f values)}


\newpage


# Introduction
Investigating macroevolutionary patterns of trait variation requires a phylogenetic perspective, because the shared ancestry among species generates statistical non-independence [@Felsenstein1985; @HarveyPagel1991]. Accounting for this evolutionary non-independence is the purview of *phylogenetic comparative methods* (PCMs); a suite of analytical tools that condition the data on the phylogeny through the course of statisical evaluations of phenotypic trends [e.g., @Grafen1989; @GarlandIves2000; @Rohlf2001; @ButlerKing2004]. The past several decades have witnessed a rapid expansion in the development of PCMs to address an ever-growing set of macroevolutionary hypotheses [@MartinsHansen1997; @OMeara_et_al2006; @RevellHarmon2008; @Beaulieu_et_al2012; @Adams2014b; @Adams2014a; @AdamsCollyer2018b]. These methods are predicated on the notion that phylogenetic signal -- the tendancy for closely related species to display similar trait values -- is present in cross-species datasets [@Felsenstein1985; @Pagel1999; @Blomberg_et_al2003]. Indeed, under numerous evolutionary models, phylogenetic signal is to be expected, as stochastic character change along the hierarchical structure of the tree of life generates trait covaration among related taxa [see @Felsenstein1985; @Blomberg_et_al2003; @Revell_et_al2008]. \hfill\break

For many macroevolutionary analyses, it is often of interest to quantify the degree to which phylogenetic signal is displayed in continuous traits. Several analytical tools have been developed for this purpose [e.g., @Gittleman1990; @Abouheif1999; @Pagel1999; @Blomberg_et_al2003; @Klingenberg2010; @Adams2014a], which differ primarily in how they characterize the phylogenetic dependency of trait variation among taxa. One commonly used statistical measure, *Kappa* ($K$), expresses the strength of phylogenetic signal as the ratio of observed trait variation to the trait variation conditioned on the phylogeny; scaled by what is expected under Brownian motion given the phylogeny's size and shape [@Blomberg_et_al2003; also @Adams2014a]. Another approach, Pagel's $\lambda$ [@Pagel1999], uses maximum likelihood to fit the data to the phylogeny under some model of evolutionary change (typically Brownian motion). The inclusion of a scaling parameter, $\lambda$,  transforms the lengths of the internal branches of the phylogeny to improve the fit, and this parameter describes the degree of phylogenetic signal in the dataset [@Pagel1999; @Freckleton_et_al2002]. Pagel's $\lambda$ also has the appeal that it may be included when estimating the association of traits in a phylogenetic context, meaning that one may account for the degree of phylogenetic signal while conducting phylogenetic regression or ANOVA [see @Freckleton_et_al2002]. \hfill\break

Several studies have investigated the statistical properties of methods for estimating phylogenetic signal under various conditions [e.g., @Munkemuller_et_al2012; @Pavoine2012;  @DinizFilho2012; @MolinaVenegas2017; see also @Revell_et_al2008; @Revell2010]. These have largely focused on the ability of methods to detect the presence of phylogenetic signal (i.e., type I and type II error rates) under complex models of evolutionary change, across a range of phylogeny sizes, and with varying degrees of phylogenetic uncertainty or unresolved topologies. In terms of parameter estimation, Revell [-@Revell2010] found that regression parameters were accurately estimated when $\lambda$ was included during phylogenetic regression, and Munkmuller et al. [-@Munkemuller_et_al2012] demonstrated that estimates of phylogenetic signal obtained using various measures generally increased when input levels of phylogenetic signal were stronger. However, the precision of those estimates could not be determined, because the input levels of phylogenetic signal were simulated via a scaling factor ($w$) that was not directly comparable to the measures of phylogenetic signal being compared [see @Munkemuller_et_al2012]. One study [@Boettiger_et_al2012] found that estimates of Pagel's $\lambda$ displayed less variation when data were simulated on a large phylogeny ($N=281$) as compared to a small one ($N=13$), concluding that insufficient data (i.e., the number of species) was the underlying cause of the increased variation across parameter estimates. However, this conclusion assumes that the precision in estimating $\lambda$ remains constant across its range ($\lambda = 0 \to 1$); an assumption that to date, has not been verified. Thus, despite widespread use of Pagel's [-@Pagel1999] $\lambda$ in macroevolutionary studies, at present, we still lack a general understanding of the precision with which $\lambda$ can estimate levels of phylogenetic signal in phenotypic datasets. \hfill\break

In this study, we evaluate the precision of Pagel's $\lambda$ in estimating known levels of phylogenetic signal in phenotypic data. We use computer simulations with differing numbers of species, differently shaped phylogenies, and differing input levels of phylogenetic signal, to explore the degree to which $\lambda$ correctly identifies known levels of phylogenetic signal, and under what circumstances. We also evaluate the precision of a standardized effect size ($Z_K$) based on $Kappa$ for comparison. Additionally, we use simulations to determine how the inclusion of $\lambda$ in phylogenetic regression and ANOVA (i.e., PGLS) affects parameter estimation, and whether levels of phylogenetic signal estimated in a PGLS framework are accurate. We then survey the recent macroevolutionary literature for published papers containing estimates of $\lambda$ from empirical datasets, and compare these empirical estimates to patterns gleaned from our computer simulations. In general we find that while PGLS parameters (e.g., $\beta$) are accurately estimated with the inclusion of phylogenetic signal, estimates of $\lambda$ are not. We also find that estimates of $\lambda$ vary widely for a given input value of phylogenetic signal, and that this variation is not constant across the range of input signal, with decreased precision when phylogenetic signal is of intermediate strength. In addition, the same $\lambda_{est}$ may be obtained from datasets containing vastly different input levels of phylogenetic signal. By contrast, variation across effect sizes ($Z_K$) obtained from $Kappa$ is far more consistent across the range of input values, and the precision of $Z_K$ is generally preferable to that of $\lambda_{est}$. Further, because $Z_K$ is a standardized effect size, the strength of phylogenetic signal is more readily interpretable, and may be compared across datasets. We conclude that estimates of phylogenetic signal using Pagel's $\lambda$ are often innacurate, and thus interpreting strength of phylogenetic signal in phenotypic datasets based on this measure is compromised. By contrast, effect sizes obtained from $Kappa$ hold promise for characterizing phylogenetic signal, and for comparing the strength of phylogenetic signal across datasets.

# Materials and Methods

## *Simulations*

We conducted a series of computer simulations to evaluate the ability of Pagel's $\lambda$ to estimate known levels of phylogenetic signal. Our primary simulations were based on pure-birth phylogenies; however, we also evaluated patterns on both balanced and pectinate trees to determine whether tree shape affected our findings (see Supporting Information). Our first set of simulations evaluated the extent to which values of $\lambda$ estimated from the data corresponded with actual input levels of phylogenetic signal. For these simulations we generated 50 pure-birth phylogenies at each of six different tree sizes, ranging from 32 to 1024 taxa ($n=2^5 - 2^{10}$). Next, we rescaled the simulated phylogenies by multiplying the internal branches by $\lambda$. We used a set of values that encompassed the entire range of $\lambda$: ($\lambda_{in} = 0.0 \to 1.0$; in 21 intervals of 0.05 units), resulting in 1050 scaled phylogenies at each level of species richness ($n$). Continuous traits were then simulated on each phylogeny under a Brownian motion model of evolution to obtain datasets with known and differing levels of phylogenetic signal. These varied from datasets with no phylogenetic signal (when $\lambda_{in} =0$) to datsets with phylogenetic signal corresponding to what was expected under Brownian motion (when $\lambda_{in} =1$). \hfill\break
  
Using the simulated phylogenies we estimated the phylogenetic signal in each dataset using Pagel's $\lambda$. Next, for the 1050 datasets at each level of species richness ($n$), we assessed the relationship between $\lambda_{in}$ and $\lambda_{est}$ using regression. Additionally, the precision of $\lambda$ was approximated by observing the variation of $\lambda_{est}$ obtained at each input level of phylogenetic signal ($\lambda_{in}$). Finally, for comparison we characterized the strength of phylogenetic signal in each dataset using a standardized effect size [$Z_K$: sensu @AdamsCollyer2016; @AdamsCollyer2019b] based on $Kappa$. As suggested by Adams and Collyer [-@AdamsCollyer2019], the effect size for phylogenetic signal may be estimated as: $Z_K=\frac{K_{obs}-\mu_K}{\sigma_K}$, where $K_{obs}$ was the observed $Kappa$, and $\mu_K$ and $\sigma_K$ were the mean and standard deviation of the empirical sampling distribution of values obtained from the permutation distribution. $Z_K$ describes the strength of phylogenetic signal as a standard deviate from its sampling distribution, and thus directly measures the strength of signal in a manner that is comparable across datasets. Variation in the set of $Z_K$ at each input level of phylogenetic signal was then calculated as an estimate of precision in $Z_K$. However, because $Z_K$ differs in scale from $\lambda$, we used a linear normalization to standardize $Z_K$ to a uniform distribution ($0\rightarrow1$), and estimated the precision of $Z_K$ from the normalized values. \hfill\break

Our second set of simulations evaluated the extent to which values of $\lambda$ estimated in PGLS regression and ANOVA (i.e., $Y\sim{X}$) corresponded with actual input levels of phylogenetic signal in the response variable. As before we generated 50 pure-birth phylogenies at each of six levels of species richness ($n=2^5 - 2^{10}$), and rescaled each with a set of input $\lambda$ values ($\lambda_{in} = 0.0 - 1.0$; in 21 intervals of 0.05 units). Next, an independent variable $X$ was simulated on each phylogeny under a Brownian motion model of evolution (for PGLS regression). For phylogenetic ANOVA, random groups ($X$) were obtained by simulating a discrete (binary) character on each phylogeny. Next, the dependent variable was simulated in such a manner as to contain a known relationship with $X$ plus random error containing phylogenetic signal. This was accomplished as: $Y=\beta{X}+\epsilon$. Here, the association between $Y$ and $X$  was modeled using a range of values: $\beta=(0.0,0.25, 0.5, 0.75,1.0)$, and the residual error was modeled to contain phylogenetic signal simulated under a Brownian motion model of evolution: $\epsilon=\mathcal{N}(\mu=0,\sigma=\mathbf{C})$: [see @Revell2010 for a similar simulation design]. For each dataset, the fit of the phylogenetic regression was estimated using maximum likelihood, and parameter estimates ($\beta_{est}$ and $\lambda_{est}$) were obtained and evaluated as above. All analyses were performed in R v3.6.0 [@RCT] using the packages `geiger` [@Harmon2008], `caper` [@Orme2013], `phytools` [@Revell2012], and `geomorph` [@AdamsOtarola2013; @AdamsGeomorph]. R-scripts are found in the Supporting Information. 

## *Literature Survey*

To determine how Pagel's $\lambda$ is commonly utilized in empirical studies, we conducted a literature survey. From Google.scholar we obtained a list of all papers published in 2019 that used $\lambda$; resulting in 341 studies. For each study, we extracted all $\lambda_{est}$, the size of the phylogeny ($n$), and noted whether authors reported confidence intervals or performed significance tests assessing difference of $\lambda_{est}$ from either zero or one. We also noted whether biological interpretations based on $\lambda_{est}$ were made, and for studies that reported more than one $\lambda_{est}$, we also noted whether these were compared in some manner, and whether such comparisons were accompanied with statistical tests between $\lambda_{est}$. 

# Results 

## *Simulations* 

Our first set of simulations revealed several patterns. First, the relationship between $\lambda_{est}$ and $\lambda_{in}$ across the range input levels of phylogenetic signal was $\sim\beta=1.0$; indicating that the average $\lambda_{est}$ across datasets for a given set of simulation condition correctly reflected input levels of phylogenetic signal. However, as shown in Figure 1, the precision of those estimates varied widely, and in several interesting ways. Predictably, precision was worse at low levels of species richness, where in many cases the set of $\lambda_{est}$ spanned nearly the entire range of possible values (e.g., $n=32$; $\lambda_{in}=0.5$: range of $\lambda_{est}= 0.0\to 0.985$). Second, as species richness increased, variation across estimates of $\lambda$ decreased (Figure 1). This confirmed the pattern identified by Boettiger et al. [-@Boettiger_et_al2012] on  a small ($n=13$) versus a large ($n=281$) phylogeny, and demonstrated that the trend of increasing precision with higher species richness was general. Importantly however, our broader set of simulations revealed that the precision of $\lambda_{est}$ was not uniform across all levels of phylogenetic signal. Specifically, we found that variation in $\lambda_{est}$ was highest at intermediate levels of phylogenetic signal, and decreased at both lower and higher levels of input signal (Figure 1). This implied that the precision in estimating $\lambda$ was worse at intermediate values, and improved as the levels of phylogenetic signal were closer to $\lambda_{in}=0$ (no phylogenetic signal) or $\lambda_{in}=1$ (Brownian motion). Notably, even at large levels of species richness, the range of $\lambda_{est}$ still encompassed a substantial portion of possible values (e.g., $n=512$; $\lambda_{in}=0.5$: range of $\lambda_{est} = 0.32\to 0.68$). Likewise, the same $\lambda_{est}$ could be obtained from datasets containing vastly different input levels of phylogenetic signal (e.g., $n=512$; $\lambda_{est} = 0.5$; range of $\lambda_{in} = 0.25 \to 0.65$). Taken together, these findings reveal that $\lambda_{est}$ does not precisely characterize observed levels of phylogenetic signal in phenotypic datasets, and that biological interpretations of the strength of phylogenetic signal based on $\lambda$ may be highly inaccurate. \hfill\break

[insert Figure 1 here] \hfill\break

By contrast, when characterizing phylogenetic signal with the standardized effect size ($Z_K$) of $Kappa$, we found that the precision of $Z_K$ was more stable, as variation across datasets was far more consistent across the range of input values. For example, when $n=128$ the precision of $\lambda_{est}$ (Figure 2A) varied considerably more across input levels of phylogenetic signal than did the precision of $Z_K$ for the same datasets (Figure 2B). Further, for a given $n$, the variance in precision estimates of $Z_K$ was considerably smaller than the variance in precision estimates of $\lambda_{est}$ (Fig. 2C,D); implying that estimates of phylogenetic signal were more reliable and robust when using $Z_K$ (for additional results see Supporting Information).  Finally, it should also be recognized that because $Z_K$ is a standardized effect size, the strength of phylogenetic signal is more readily interpretable when using this measure, as $Z_K$ expresses the strength of phylogenetic signal in standard deviation units relative to the mean [see @AdamsCollyer2019]. This further implies that comparisons of the strength of phylogenetic signal among phenotypic traits are possible, and may be accomplished statistically via a two-sample test that formally compares $Z_K$ across datasets [for comparisons of multivariate effect sizes see: @AdamsCollyer2016; @AdamsCollyer2019b]. \hfill\break

[insert Figure 2 here] \hfill\break 

When $\lambda$ was incorporated in PGLS regression and ANOVA (i.e., $Y\sim{X}$), we found much the same pattern as in the previous simulations. Namely, the precision of $\lambda_{est}$ varied inversely with species richness; where greater precision was obtained at higher levels of species richness (Figure 3). Likewise, the precision in estimating $\lambda$ was worse at intermediate values (Figure 3), and improved as the levels of phylogenetic signal were closer to $\lambda_{in}=0$ (no phylogenetic signal) or $\lambda_{in}=1$ (Brownian motion). Generally, the spread of estimates was slightly broader when $\lambda$  was co-estimated with regression parameters in PGLS regression (Figure 3), as compared to when $\lambda$ was estimated in cases only the dependent variable (Y) was considered (Figure 1). Finally, found that regression parameters ($\beta$) were accurately estimated when $\lambda$ was included during phylogenetic regression; a result which confirmed earlier findings of Revell [-@Revell2010] (see Supporting Information). \hfill\break

[insert Figure 3 here] 

## *Literature Survey*

We found 182 manuscripts from 2019 that estimated and reported Pagel's lambda values using PGLS methods. These papers averaged 8.527 lambda values, ranging from a single lambda estimate up to 71 estimated lambdas. Almost exactly half of the published lambda estimates were either below 0.05 (25.32%) or above 0.9 (24.74%; Figure 3). 73.32% of the published lambdas were estimated using phylogenies with fewer than 200 tips, and 348 lambda estimates (8.57% of all published estimates) came from phylogenies with fewer than 30 tips.  \hfill\break

[insert Figure 4 here] \hfill\break

Many of the reviewed manuscripts liberally interpreted the magnitude of the estimate lambda, using phrases such as "strong" or "weak" phylogentic signal when statistically, all that was clear was a difference between the estimated lambda and 0 or 1 respectively. We estimated that about 20.49% of the manuscripts revealed some sort of biological interpretation of the magnitude of estimated phylogenetic signal that overreached the statistical findings. We also identified seven manuscripts as having inappropriately interpreted differences in lambda values, indicating that some traits had stronger or weaker signal than other traits without the appropriate statistical tests. \hfill\break

As is evidenced by macroevolutionary papers published in 2019 papers, Pagel's lambda estimation methods are often misused and over-interpretted. Despite the urging of Boettiger and colleagues to publish confidence intervals with all lambda parameter estimates, only 18% of papers published in 2019 do so.  

# Results

# Discussion

1: summary paragraph

2: expand on Lambda..
lambda innacurate, not precise, level of precision varies with input physig (worse in mid-range). NEW RESULT.  We are first to show this.  NOTE: pattern is obvious with reflection. Since it is a 'bounded' parameter estimation should be best at the extremes... (state this?).. hmm. 

Patterns worse with PGLS, though beta still estimated properly. Conclusion, lambda not overly useful.

3: By contrast, effect size Z-K useful, equally precise across range of values. Can be used to characterize the strength of physignal, and because robust to input levels, etc. may be used to compare across datasets.

Somewhere, recognize that this is somewhat 'backwards' from prior recommendations where Kappa had somewhat lower performance in terms of type I and type II error (which?? I forget). However, recall that those studies did not examine the precision of the estimates. Nor was Z-k included, because it was not yet invented. So Use of Z-k should make good sense here. 

Closing paragraph. 

\hfill\break

More discussion paragraphs

\newpage

# References

 \setlength{\parindent}{-0.25in}
 \setlength{\leftskip}{0.25in}
 \setlength{\parskip}{8pt}
 \noindent

<div id="refs"></div>
 
\newpage

# Figure Legends

\textbf{Figure 1}. Precision of Pagel's $\lambda$ across known levels of input phylogenetic signal ($\lambda_{in}$) on phylogenies of various sizes. As phylogenies increase in size, variation in $\lambda_{in}$ decreases; however the precision is not constant across the range of input levels ($\lambda_{in}: 0 \to 1$), and is highest at intermediate levels of phylogenetic signal. \hfill\break

\textbf{Figure 2}.  Variation in estimates of phylogenetic signal across input levels of phylogenetic signal. (A) Estimates of Pagel's $\lambda$ for data simulated on phylogenies with 128 taxa ($n=128$), (B) Estimates of $Z_K$ for data simulated on phylogenies with 128 taxa ($n=128$), (C) Variance in the variation of $\lambda_{est}$ across input levels of phylogenetic signal, estimated on phylogenies containing differing numbers of species. (D) Variance in the variation of $Z_K$ across input levels of phylogenetic signal, estimated on phylogenies containing differing numbers of species.    \hfill\break

\textbf{Figure 3}. Precision of Pagel's $\lambda$ when incorporated in phylogenetic regression ($|Y\sim X$), across known levels of input phylogenetic signal ($\lambda_{in}$) on phylogenies of various sizes. As phylogenies increase in size, variation in $\lambda_{in}$ decreases; however the precision is not constant across the range of input levels ($\lambda_{in}: 0 \to 1$), and is highest at intermediate levels of phylogenetic signal. \hfill\break

\textbf{Figure 4}. Frequency of estimated lambda values published in manuscripts in 2019. The majority of these values were close to 0 or 1, and from phylogenies with fewer than 200 taxa.

\newpage

```{r, echo = FALSE, out.width="95%"}
include_graphics("Fig1.png")  

```

\singlespacing \textbf{Figure 1}. Precision of Pagel's $\lambda$ across known levels of input phylogenetic signal ($\lambda_{in}$) on phylogenies of various sizes. As phylogenies increase in size, variation in $\lambda_{in}$ decreases; however the precision is not constant across the range of input levels ($\lambda_{in}: 0 \to 1$), and is highest at intermediate levels of phylogenetic signal. 

\newpage
```{r, echo = FALSE, out.width="95%"}
include_graphics("Fig2.png")  

```

\singlespacing \textbf{Figure 2}.  Variation in estimates of phylogenetic signal across input levels of phylogenetic signal. (A) Estimates of Pagel's $\lambda$ for data simulated on phylogenies with 128 taxa ($n=128$), (B) Estimates of $Z_K$ for data simulated on phylogenies with 128 taxa ($n=128$), (C) Variance in the variation of $\lambda_{est}$ across input levels of phylogenetic signal, estimated on phylogenies containing differing numbers of species. (D) Variance in the variation of $Z_K$ across input levels of phylogenetic signal, estimated on phylogenies containing differing numbers of species.  

\newpage

```{r, echo = FALSE, out.width="95%"}
include_graphics("Fig3.png")  

```

\singlespacing \textbf{Figure 3}. Precision of Pagel's $\lambda$ when incorporated in phylogenetic regression ($|Y\sim X$), across known levels of input phylogenetic signal ($\lambda_{in}$) on phylogenies of various sizes. As phylogenies increase in size, variation in $\lambda_{in}$ decreases; however the precision is not constant across the range of input levels ($\lambda_{in}: 0 \to 1$), and is highest at intermediate levels of phylogenetic signal.

\newpage

```{r, echo = FALSE, out.width="95%"}
include_graphics("Fig4.png")  

```

\singlespacing \textbf{Figure 4}.Frequency of estimated lambda values published in manuscripts in 2019. The majority of these values were close to 0 or 1, and from phylogenies with fewer than 200 taxa.
